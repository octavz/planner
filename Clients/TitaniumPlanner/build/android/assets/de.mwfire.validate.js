function validate(e,t){if(!_)return Ti.API.error("[validationModule] this plugin requires underscore!");if(!e||!_.isArray(e)||!e.length)return Ti.API.error("[validationModule] Please specify at least one input field!");t=t||{},errors=[];for(var r=0,i=e.length;i>r;r++){var n=e[r];n.rules&&validateField(n)}return errors.length>0?(t.showAlert&&showAlert(),!1):!0}function validateField(e){for(var t=e.rules.split("|"),r=e.rules.indexOf("required"),i=!e.value||""===e.value||void 0===e.value,n=0,o=t.length;o>n;n++){var a=t[n],s=null,l=!1,u=ruleRegex.exec(a);if((e.isSwitch||-1!==r||!i)&&(u&&(a=u[1],s=u[2]),"!"===a.charAt(0)&&(a=a.substring(1,a.length)),"function"==typeof hooks[a]&&("matches"===a?hooks[a].apply(this,[e.value,e.matchField.value])||(l=!0):hooks[a].apply(this,[e.value,s])||(l=!0)),l)){var c=messages[a],d=c.replace("%s",e.name);"matches"===a&&(s=e.matchField.name),s&&(d=d.replace("%p",s)),errors.push({message:d});break}}}function showAlert(){for(var e="",t=0,r=errors.length;r>t;t++)e+=errors[t].message+"\n";Ti.UI.createAlertDialog({title:L("validationErrorTitle","Validation errors!"),message:e}).show()}var errors=[],_=require("alloy")._,messages={required:L("validationRequiredField","The %s field is required."),matches:L("validationMatchField","The %s field does not match the %p field."),valid_email:L("validationValidEmail","The %s field must contain a valid email address."),valid_emails:L("validationValidEmails","The %s field must contain all valid email addresses."),min_length:L("validationMinLength","The %s field must be at least %p characters in length."),max_length:L("validationMaxLength","The %s field must not exceed %p characters in length."),exact_length:L("validationExactLength","The %s field must be exactly %p characters in length."),greater_than:L("validationGreaterThan","The %s field must contain a number greater than %p."),is_checked:L("validationIsChecked","%s has to be set."),agree_on:L("validationAgreeOn","You have to agree to %s."),age_at_least:L("validationAgeAtLeast","You must be at least %p years old to continue!"),less_than:L("validationLessThan","The %s field must contain a number less than %p."),alpha:L("validationAlpha","The %s field must only contain alphabetical characters."),alpha_numeric:L("validationAlphaNumeric","The %s field must only contain alpha-numeric characters."),alpha_dash:L("validationDash","The %s field must only contain alpha-numeric characters, underscores, and dashes."),numeric:L("validationNumeric","The %s field must contain only numbers."),integer:L("validationInteger","The %s field must contain an integer."),decimal:L("validationDecimal","The %s field must contain a decimal number."),is_natural:L("validationIsNatural","The %s field must contain only positive numbers."),is_natural_no_zero:L("validationIsNaturalNoZero","The %s field must contain a number greater than zero."),valid_ip:L("validationValidIp","The %s field must contain a valid IP."),valid_base64:L("validationValidBase64","The %s field must contain a base64 string."),valid_credit_card:L("validationValidCreditCard","The %s field must contain a valid credit card number."),valid_url:L("validationValidUrl","The %s field must contain a valid URL."),valid_zip_code:L("validationValidZipCode","The %s field must be a valid Zip Codeâ„¢.")},ruleRegex=/^(.+?)\[(.+)\]$/,numericRegex=/^[0-9]+$/,integerRegex=/^\-?[0-9]+$/,decimalRegex=/^\-?[0-9]*\.?[0-9]+$/,emailRegex=/^[a-zA-Z0-9.!#$%&amp;'*+\-\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*$/,alphaRegex=/^[a-z]+$/i,alphaNumericRegex=/^[a-z0-9]+$/i,alphaDashRegex=/^[a-z0-9_\-]+$/i,naturalRegex=/^[0-9]+$/i,naturalNoZeroRegex=/^[1-9][0-9]*$/i,ipRegex=/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,base64Regex=/[^a-zA-Z0-9\/\+=]/i,numericDashRegex=/^[\d\-\s]+$/,urlRegex=/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,zipCodeRegex=/^[0-9]{5}(-[0-9]{4})?$/,hooks={required:function(e){return null!==e&&""!==e},matches:function(e,t){return e===t},valid_email:function(e){return emailRegex.test(e)},min_length:function(e,t){return numericRegex.test(t)?e.length>=parseInt(t,10):!1},max_length:function(e,t){return numericRegex.test(t)?e.length<=parseInt(t,10):!1},exact_length:function(e,t){return numericRegex.test(t)?e.length===parseInt(t,10):!1},greater_than:function(e,t){return decimalRegex.test(e)?parseFloat(e)>parseFloat(t):!1},less_than:function(e,t){return decimalRegex.test(e)?parseFloat(e)<parseFloat(t):!1},age_at_least:function(e,t){var r=new Date,i=new Date(e),n=r.getFullYear()-i.getFullYear(),o=r.getMonth()-i.getMonth();return(0>o||0===o&&r.getDate()<i.getDate())&&n--,parseInt(n)>=parseInt(t)},is_checked:function(e){return e},agree_on:function(e){return e},alpha:function(e){return alphaRegex.test(e)},alpha_numeric:function(e){return alphaNumericRegex.test(e)},alpha_dash:function(e){return alphaDashRegex.test(e)},numeric:function(e){return numericRegex.test(e)},integer:function(e){return integerRegex.test(e)},decimal:function(e){return decimalRegex.test(e)},is_natural:function(e){return naturalRegex.test(e)},is_natural_no_zero:function(e){return naturalNoZeroRegex.test(e)},valid_ip:function(e){return ipRegex.test(e)},valid_base64:function(e){return base64Regex.test(e)},valid_url:function(e){return urlRegex.test(e)},valid_credit_card:function(e){if(!numericDashRegex.test(e))return!1;for(var t=0,r=0,i=!1,n=e.replace(/\D/g,""),o=n.length-1;o>=0;o--){var a=n.charAt(o);r=parseInt(a,10),i&&(r*=2)>9&&(r-=9),t+=r,i=!i}return t%10===0},valid_zip_code:function(e){return zipCodeRegex.test(e)}};exports.validate=validate;